---
allowed-tools: [Bash, Read, Glob, TodoWrite, Edit, Grep]
description: 'Git å·¥ä½œæµï¼šIssue/Commit/PR è‡ªåŠ¨åŒ–'
agent: quick
---

## ç”¨æ³•

```bash
/git-commit-and-pr                           # è‡ªåŠ¨æ£€æµ‹å¹¶æ‰§è¡Œæ‰€éœ€é˜¶æ®µ
/git-commit-and-pr --issue <ID>              # æŒ‡å®šå…³è” Issue
/git-commit-and-pr --issue-only              # ä»…åˆ›å»º Issue
/git-commit-and-pr --pr --base <BRANCH>      # ä»…åˆ›å»º PR
```

---

## æ‰§è¡Œæµç¨‹

### Step 1: çŠ¶æ€æ£€æµ‹

å¹¶è¡Œæ‰§è¡Œï¼š

```bash
git status --short
git branch --show-current
git log -1 --format='%H %s' 2>/dev/null || echo "no-commits"
```

æ ¹æ®çŠ¶æ€å†³å®šæ‰§è¡Œé˜¶æ®µï¼š

- æ—  Issue æˆ– `--issue-only` â†’ æ‰§è¡Œ Issue åˆ›å»º
- æœ‰æœªæäº¤ä¿®æ”¹ â†’ æ‰§è¡Œ Commit æµç¨‹
- å·¥ä½œæ ‘å¹²å‡€ä¸”åœ¨åŠŸèƒ½åˆ†æ”¯ â†’ æ‰§è¡Œ PR åˆ›å»º

**ç¦æ­¢åœ¨ main/master ç›´æ¥æäº¤ã€‚**

---

### Step 2: Issue åˆ›å»ºï¼ˆå¯é€‰ï¼‰

#### 2.1 ä¿¡æ¯æ”¶é›†ä¸åˆ†æ

**ä»£ç å˜æ›´åˆ†æï¼ˆå¹¶è¡Œæ‰§è¡Œï¼‰ï¼š**

```bash
git status --short
git diff --stat
```

**é‡å¤æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰ï¼š**

```bash
gh issue list --search "<å…³é”®è¯>" --limit 5
```

**ä¸Šä¸‹æ–‡æç‚¼ï¼š**

- ä»å¯¹è¯å†å²ä¸­æå–é—®é¢˜æè¿°å’Œéœ€æ±‚èƒŒæ™¯
- è¯†åˆ«å—å½±å“çš„æ¨¡å—ï¼ˆbackend/front/admin/sharedï¼‰
- ç¡®è®¤æ˜¯å¦æ¶‰åŠæ•°æ®åº“ã€API æˆ–åŸºç¡€è®¾æ–½å˜æ›´

#### 2.2 Issue å†…å®¹ç”Ÿæˆ

**æ ‡é¢˜ç”Ÿæˆç­–ç•¥ï¼š**

- æ ¼å¼ï¼š`[æ¨¡å—] ç®€æ´æè¿°` æˆ– `[ç±»å‹] åŠŸèƒ½/é—®é¢˜æè¿°`
- ç¤ºä¾‹ï¼š
  - `[Backend] ä¼˜åŒ–ç”¨æˆ·è®¤è¯æµç¨‹æ€§èƒ½`
  - `[Bug] ä¿®å¤èŠå¤©æ¶ˆæ¯ä¸¢å¤±é—®é¢˜`
  - `[è§„èŒƒ] ç»Ÿä¸€é”™è¯¯ç å‘½åè§„èŒƒ`
- ä¼˜å…ˆä½¿ç”¨ç”¨æˆ·æä¾›çš„ `--title` å‚æ•°

**æ ‡ç­¾é€‰æ‹©ï¼ˆåŸºäºå†…å®¹è‡ªåŠ¨æ·»åŠ ï¼‰ï¼š**

- `bug` - Bug ä¿®å¤
- `enhancement` - åŠŸèƒ½å¢å¼º
- `documentation` - æ–‡æ¡£ç›¸å…³
- `performance` - æ€§èƒ½ä¼˜åŒ–
- `refactor` - ä»£ç é‡æ„
- `backend` / `frontend` - æ¨¡å—æ ‡ç­¾
- `infrastructure` - åŸºç¡€è®¾æ–½

**æ­£æ–‡ç»“æ„æ¨¡æ¿ï¼š**

```markdown
## èƒŒæ™¯

[å½“å‰åœºæ™¯ã€è®¨è®ºæ¥æºã€ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªæ”¹åŠ¨]

## ç°çŠ¶/é—®é¢˜

[è§‚å¯Ÿåˆ°çš„é—®é¢˜ã€ç°æœ‰å®ç°çš„ä¸è¶³ã€éœ€è¦æ”¹è¿›çš„åœ°æ–¹]

## æœŸæœ›è¡Œä¸º

[ç›®æ ‡çŠ¶æ€ã€æœŸæœ›ç»“æœã€éªŒæ”¶æ ‡å‡†]

## æ‰§è¡Œè®¡åˆ’

- [ ] æ­¥éª¤ 1
- [ ] æ­¥éª¤ 2
- [ ] æ­¥éª¤ 3

## å½±å“èŒƒå›´

[å—å½±å“çš„æ¨¡å—ã€å¯èƒ½çš„é£é™©ã€éœ€è¦é€šçŸ¥çš„å›¢é˜Ÿ]

## ç›¸å…³èµ„æº

[ç›¸å…³ Issueã€PRã€æ–‡æ¡£é“¾æ¥]
```

#### 2.3 æ‰§è¡Œ Issue åˆ›å»º

ä½¿ç”¨ heredoc æ ¼å¼æ‰§è¡Œ gh CLIï¼š

```bash
gh issue create \
  --title "[æ¨¡å—] é—®é¢˜æ‘˜è¦" \
  --label label1 --label label2 \
  --body-file - <<'MSG'
## èƒŒæ™¯

[ä»å¯¹è¯å†å²æç‚¼çš„èƒŒæ™¯ä¿¡æ¯]

## ç°çŠ¶/é—®é¢˜

[ä»£ç å˜æ›´åˆ†æç»“æœå’Œé—®é¢˜æè¿°]

## æœŸæœ›è¡Œä¸º

[ç›®æ ‡çŠ¶æ€å’ŒéªŒæ”¶æ ‡å‡†]

## æ‰§è¡Œè®¡åˆ’

- [ ] æ­¥éª¤ 1
- [ ] æ­¥éª¤ 2

## å½±å“èŒƒå›´

[å—å½±å“æ¨¡å—åˆ—è¡¨]
MSG
```

**è´¨é‡æ£€æŸ¥æ¸…å•ï¼š**

- [ ] æ ‡é¢˜ç®€æ´æ˜ç¡®ï¼ˆâ‰¤ 80 å­—ç¬¦ï¼‰
- [ ] èƒŒæ™¯ä¿¡æ¯å®Œæ•´
- [ ] é—®é¢˜/éœ€æ±‚æè¿°æ¸…æ™°
- [ ] æ‰§è¡Œæ­¥éª¤å¯æ“ä½œ
- [ ] å½±å“èŒƒå›´å·²æ ‡æ³¨
- [ ] æ ‡ç­¾é€‰æ‹©å‡†ç¡®
- [ ] æ— æ•æ„Ÿä¿¡æ¯ï¼ˆ.envã€å¯†é’¥ç­‰ï¼‰

#### 2.4 è¾“å‡º Issue ä¿¡æ¯

æˆåŠŸåˆ›å»ºåï¼Œè§£æ gh è¾“å‡ºè·å– Issue ç¼–å·ï¼š

```
âœ… Issue åˆ›å»ºæˆåŠŸ

Issue: #<ç¼–å·>
æ ‡é¢˜: <æ ‡é¢˜>
é“¾æ¥: <GitHub URL>
æ ‡ç­¾: <æ ‡ç­¾åˆ—è¡¨>
```

å­˜å‚¨ Issue ID ä¾›åç»­ commit å’Œ PR ä½¿ç”¨ã€‚

`--issue-only` æ—¶åœ¨æ­¤ç»ˆæ­¢ã€‚

---

### Step 3: Commit æµç¨‹

#### 3.1 æš‚å­˜å˜æ›´

```bash
git add -A
git diff --cached --stat
```

#### 3.2 ç”Ÿæˆæäº¤

åˆ†æ `git diff --cached` å†…å®¹ï¼Œç”Ÿæˆ commit messageï¼š

```bash
git commit -F - <<'EOF'
<type>: <æ¦‚è¦>

å˜æ›´è¯´æ˜ï¼š
- <å˜æ›´é¡¹1>
- <å˜æ›´é¡¹2>

Refs: #<issue-id>
EOF
```

type ç±»å‹ï¼šfeat/fix/refactor/docs/chore/test

#### 3.3 ç¡®è®¤æäº¤

```bash
git status
git log -1 --oneline
```

---

### Step 4: PR åˆ›å»º

#### 4.1 æ¨é€åˆ†æ”¯

```bash
git push -u origin HEAD
```

#### 4.2 åˆ†æå˜æ›´

```bash
git log origin/master..HEAD --oneline
git diff origin/master...HEAD --stat
```

#### 4.3 åˆ›å»º PR

```bash
gh pr create --title '<type>: <æ¦‚è¦>' --body-file - <<'EOF'
## å˜æ›´è¯´æ˜

- <å˜æ›´é¡¹>

## æµ‹è¯•

- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡

Closes: #<issue-id>
EOF
```

#### 4.4 æç¤ºè¯„å®¡

åˆ›å»º PR æˆåŠŸåï¼Œæé†’ç”¨æˆ·è¿è¡Œè‡ªåŠ¨è¯„å®¡æµç¨‹ï¼š

```
ğŸ’¡ æç¤ºï¼šè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨è‡ªåŠ¨è¯„å®¡
/dx:pr-review-loop --pr <PR_NUMBER>
```

---

## è¾“å‡ºæ ¼å¼

**æˆåŠŸï¼š**

```
âœ… å®Œæˆ

Issue: #<ç¼–å·> <æ ‡é¢˜>
Commit: <hash> <ä¸»é¢˜>
PR: #<ç¼–å·> â†’ <URL>

ğŸ’¡ ä¸‹ä¸€æ­¥ï¼šè¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨è‡ªåŠ¨è¯„å®¡
/dx:pr-review-loop --pr <ç¼–å·>
```

**éƒ¨åˆ†å®Œæˆï¼š**

```
âš ï¸ åœæ­¢äº [é˜¶æ®µ]

å·²å®Œæˆï¼š<åˆ—è¡¨>
é˜»å¡ï¼š<åŸå› >
ç»§ç»­ï¼š/dx:git-commit-and-pr --issue <ç¼–å·>
```
